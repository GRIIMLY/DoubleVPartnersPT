Scaffold-DbContext "Server=NICOLAS\SQLEXPRESS01;Database=PTDoublePartners;User Id=AdminPartner;password=21sadf2342;TrustServerCertificate=True;MultipleActiveResultSets=true;" Microsoft.EntityFrameworkCore.SqlServer -OutputDir Modelss -Tables "Personas", "Usuario" -ContextDir ContextDB -Context DoubleVPartnersDB
CREATE DATABASE PTDoublePartners;
GO

USE PTDoublePartners;
GO
-- Crear tabla Usuario
CREATE TABLE Usuario (
    Identificador INT PRIMARY KEY IDENTITY(1,1),
    Usuario NVARCHAR(50) UNIQUE,
    Pass NVARCHAR(50),
    FechaCreacion DATETIME DEFAULT GETDATE()
);
GO

CREATE TABLE Personas (
    Identificador INT PRIMARY KEY IDENTITY(1,1),
    Nombres NVARCHAR(50),
    Apellidos NVARCHAR(50),
    NumeroIdentificacion NVARCHAR(20),
    Email NVARCHAR(50),
    TipoIdentificacion NVARCHAR(20),
    FechaCreacion DATETIME DEFAULT GETDATE(),
    NumeroIdentificacionConcatenado AS (TipoIdentificacion + ' ' + NumeroIdentificacion) PERSISTED,
    NombresApellidosConcatenados AS (Nombres + ' ' + Apellidos) PERSISTED,
	UsuarioId INT,
    FOREIGN KEY (UsuarioId) REFERENCES Usuario(Identificador)
);
GO



CREATE PROCEDURE sp_ConsultarPersonas
AS
BEGIN
    SELECT 
        Identificador,
        Nombres,
        Apellidos,
        NumeroIdentificacion,
        Email,
        TipoIdentificacion,
        FechaCreacion,
        NumeroIdentificacionConcatenado,
        NombresApellidosConcatenados
    FROM 
        Personas;
END;
GO


USE PTDoublePartners;
GO

CREATE LOGIN AdminPartner
WITH PASSWORD = '21sadf2342';
GO
USE PTDoublePartners;
GO
CREATE USER AdminPartner
FOR LOGIN AdminPartner;
GO

ALTER ROLE db_owner
ADD MEMBER AdminPartner;
GO